model agregado {
  id_agregado           String                  @id @default(cuid())
  img_url               String
  nombre                String
  precio                Float
  activo                Boolean                 @default(true)
  createdat             DateTime                @default(now())
  updatedat             DateTime
  agregado_on_categoria agregado_on_categoria[]
}

model agregado_on_categoria {
  id_agregado        String
  id_cat_producto    String
  agregado           agregado           @relation(fields: [id_agregado], references: [id_agregado], onDelete: NoAction, onUpdate: NoAction)
  categoria_producto categoria_producto @relation(fields: [id_cat_producto], references: [id_cat_producto], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_agregado, id_cat_producto])
}

model categoria_insumo {
  id_cat_insumo String   @id @default(cuid())
  nombre        String
  activo        Boolean  @default(true)
  insumo        insumo[]
}

model categoria_producto {
  id_cat_producto              String                         @id @default(cuid())
  nombre                       String
  indicacion                   String?
  nro_frutas                   Int                            @default(0)
  nro_toppings                 Int                            @default(0)
  permite_adicionar            Boolean                        @default(false)
  activo                       Boolean                        @default(true)
  agregado_on_categoria        agregado_on_categoria[]
  descuento_categoria_producto descuento_categoria_producto[]
  producto                     producto[]
}

model categoria_promocion {
  id_cat_promocion String      @id @default(cuid())
  nombre           String
  activo           Boolean     @default(true)
  promocion        promocion[]
}

model descuento_categoria_producto {
  id_descuento_categoria String             @id @default(cuid())
  valor_descuento        Float
  unidad_descuento       UnidadDescuento
  cantidad_minima_orden  Int                @default(0)
  fecha_inicio           DateTime
  fecha_fin              DateTime
  id_cat_producto        String
  categoria_producto     categoria_producto @relation(fields: [id_cat_producto], references: [id_cat_producto], onDelete: NoAction, onUpdate: NoAction)
}

model descuento_producto {
  id_descuento          String          @id @default(cuid())
  valor_descuento       Float
  unidad_descuento      UnidadDescuento
  cantidad_minima_orden Int             @default(0)
  fecha_inicio          DateTime
  fecha_fin             DateTime
  id_producto           String
  producto              producto        @relation(fields: [id_producto], references: [id_producto], onDelete: NoAction, onUpdate: NoAction)
}

model insumo {
  id_insumo        String           @id @default(cuid())
  img_url          String
  nombre           String
  cantidad         Float
  medida           TipoMedida?
  activo           Boolean          @default(true)
  id_cat_insumo    String
  createdat        DateTime
  updatedat        DateTime
  categoria_insumo categoria_insumo @relation(fields: [id_cat_insumo], references: [id_cat_insumo], onDelete: NoAction, onUpdate: NoAction)
}

model lista_producto {
  id_pedido       String
  id_producto     String
  cantidad        Int
  precio_cantidad Float
  pedido          Pedido   @relation(fields: [id_pedido], references: [id_pedido], onDelete: NoAction, onUpdate: NoAction)
  producto        producto @relation(fields: [id_producto], references: [id_producto], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_pedido, id_producto])
}

model lista_promocion {
  id_pedido       String
  id_promocion    String
  cantidad        Int
  precio_cantidad Float
  pedido          Pedido    @relation(fields: [id_pedido], references: [id_pedido], onDelete: NoAction, onUpdate: NoAction)
  promocion       promocion @relation(fields: [id_promocion], references: [id_promocion], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_pedido, id_promocion])
}

model Pedido {
  id_pedido       String            @id @default(cuid())
  subtotal        Float
  desc_promocion  Float
  desc_puntos     Float?
  impuesto        Float
  total           Float
  estado_pedido   EstadoPedido      @default(Procesando)
  createdat       DateTime          @default(now())
  updatedat       DateTime
  id_usuario      String
  lista_producto  lista_producto[]
  lista_promocion lista_promocion[]
  user            User              @relation(fields: [id_usuario], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model producto {
  id_producto           String                  @id @default(cuid())
  img_url               String
  nombre                String
  descripcion           String
  agregados             String[]
  id_cat_producto       String
  activo                Boolean                 @default(true)
  createdat             DateTime                @default(now())
  updatedat             DateTime
  descuento_producto    descuento_producto[]
  lista_producto        lista_producto[]
  categoria_producto    categoria_producto      @relation(fields: [id_cat_producto], references: [id_cat_producto], onDelete: NoAction, onUpdate: NoAction)
  producto_on_promocion producto_on_promocion[]
  producto_tamanio      producto_tamanio[]
}

model producto_on_promocion {
  id_promocion String
  id_producto  String
  cantidad     Float
  producto     producto  @relation(fields: [id_producto], references: [id_producto], onDelete: NoAction, onUpdate: NoAction)
  promocion    promocion @relation(fields: [id_promocion], references: [id_promocion], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_promocion, id_producto])
}

model producto_tamanio {
  id_producto_tamanio String   @id @default(cuid())
  id_producto         String
  tamanio             String?
  precio              Float
  precio_puntos       Int?
  activo              Boolean  @default(true)
  createdat           DateTime @default(now())
  updatedat           DateTime
  producto            producto @relation(fields: [id_producto], references: [id_producto], onDelete: NoAction, onUpdate: NoAction)
}

model promocion {
  id_promocion          String                  @id @default(cuid())
  img_url               String
  nombre                String
  descripcion           String
  precio_base           Float
  precio_oferta         Float
  estado_promocion      Boolean                 @default(false)
  tipo_promocion        TipoPromocion
  dias_aplicacion       String[]
  fecha_inicio          DateTime
  fecha_fin             DateTime
  activo                Boolean                 @default(true)
  id_cat_promocion      String
  createdat             DateTime                @default(now())
  updatedat             DateTime
  lista_promocion       lista_promocion[]
  producto_on_promocion producto_on_promocion[]
  categoria_promocion   categoria_promocion     @relation(fields: [id_cat_promocion], references: [id_cat_promocion], onDelete: NoAction, onUpdate: NoAction)
}

enum TipoMedida {
  Paquete
  Botella
  Caja
  Unidad
  Kilogramo
  Gramo
  Litro
  Mililitro
  Metro
  Centimetro
  Milimetro
}

enum TipoPromocion {
  Combo_con_descuento @map("Combo con descuento")
  Oferta_especial     @map("Oferta especial")
}

enum EstadoPedido {
  Procesando
  Pendiente
  Aceptado
  Rechazado
  Enviado
}

enum UnidadDescuento {
  Porcentaje
  Valor_moneda @map("Valor moneda")
}
